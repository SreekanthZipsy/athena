


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>athena.solvers package &mdash; Athena  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="athena.utils package" href="athena.utils.html" />
    <link rel="prev" title="athena.models package" href="athena.models.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <h1> Athena</h1>
    </div>
  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="athena.html">athena package</a></li>
<li class="toctree-l1"><a class="reference internal" href="athena.layers.html">athena.layers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="athena.models.html">athena.models package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">athena.solvers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="athena.utils.html">athena.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">athena</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="athena.html">athena package</a> &gt;</li>
        
      <li>athena.solvers package</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/apis/athena.solvers.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="athena-solvers-package">
<h1>athena.solvers package<a class="headerlink" href="#athena-solvers-package" title="Permalink to this headline">¶</a></h1>
<p>A <code class="docutils literal notranslate"><span class="pre">Solver</span></code> is a class which is used to train the model. These classes encapsulate the training regime, which is specific to the problem at hand.
Some of these classes also contain helper methods that are specific to the problem, for example, the <code class="docutils literal notranslate"><span class="pre">ClassificationSolver</span></code> which is used to train
classification problems contains a helper method to get <code class="docutils literal notranslate"><span class="pre">n</span></code> misclassified images.</p>
<div class="section" id="module-athena.solvers.classification_solver">
<span id="classification-solver-module"></span><h2><code class="docutils literal notranslate"><span class="pre">classification_solver</span></code> module<a class="headerlink" href="#module-athena.solvers.classification_solver" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="athena.solvers.classification_solver.ClassificationSolver">
<em class="property">class </em><code class="sig-prename descclassname">athena.solvers.classification_solver.</code><code class="sig-name descname">ClassificationSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/classification_solver.html#ClassificationSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.classification_solver.ClassificationSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">athena.solvers.base_solver.BaseSolver</span></code></p>
<p>A solver for classification problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<em>nn.Module</em>) – The model to act on.</p>
</dd>
</dl>
<dl class="py method">
<dt id="athena.solvers.classification_solver.ClassificationSolver.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epochs</span></em>, <em class="sig-param"><span class="n">train_loader</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">scheduler</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">test_loader</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">'cpu'</span></em>, <em class="sig-param"><span class="n">loss_fn</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_tqdm</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/classification_solver.html#ClassificationSolver.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.classification_solver.ClassificationSolver.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>int</em>) – The number of epochs to train for.</p></li>
<li><p><strong>train_loader</strong> (<em>DataLoader</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the training data.</p></li>
<li><p><strong>optimizer</strong> (<em>Optimizer</em>) – The optimizer to use.</p></li>
<li><p><strong>scheduler</strong> (<em>LRScheduler</em><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">LRScheduler</span></code> to use. Defaults to None.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the test data. Defaults to None.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – A valid pytorch device string. Defaults to <code class="docutils literal notranslate"><span class="pre">cpu</span></code>.</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>optional</em>) – The loss function to use. If not given, model                 will be trained using negative log likelihood loss with reduction as ‘mean’</p></li>
<li><p><strong>use_tqdm</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses tqdm instead of a keras style progress bar (<code class="docutils literal notranslate"><span class="pre">pkbar</span></code>). Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An History object containing training information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="athena.utils.html#athena.utils.history.History" title="athena.utils.history.History">History</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="athena.solvers.classification_solver.ClassificationSolver.train_step">
<code class="sig-name descname">train_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train_loader</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">scheduler</span></em>, <em class="sig-param"><span class="n">device</span></em>, <em class="sig-param"><span class="n">loss_fn</span></em>, <em class="sig-param"><span class="n">use_tqdm</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/classification_solver.html#ClassificationSolver.train_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.classification_solver.ClassificationSolver.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single train step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<em>DataLoader</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the training data.</p></li>
<li><p><strong>optimizer</strong> (<em>Optimizer</em>) – The optimizer to use.</p></li>
<li><p><strong>scheduler</strong> (<em>LRScheduler</em>) – The LR scheduler to use.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – A valid pytorch device string.</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em>) – The loss function to use.</p></li>
<li><p><strong>use_tqdm</strong> (<em>bool</em>) – If True, uses tqdm instead of a keras style progress bar (<code class="docutils literal notranslate"><span class="pre">pkbar</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple consisting of the average train loss and average
train accuracy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="athena.solvers.classification_solver.ClassificationSolver.test_step">
<code class="sig-name descname">test_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">test_loader</span></em>, <em class="sig-param"><span class="n">device</span></em>, <em class="sig-param"><span class="n">loss_fn</span></em>, <em class="sig-param"><span class="n">flush_print</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/classification_solver.html#ClassificationSolver.test_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.classification_solver.ClassificationSolver.test_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single test step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_loader</strong> (<em>DataLoader</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the test data.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – A valid pytorch device string.</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em>) – The loss function to use.</p></li>
<li><p><strong>flush_print</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to flush the print statement or not. Needed when tqdm is used in a notebook. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple consisting of the average test loss and average test accuracy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="athena.solvers.classification_solver.ClassificationSolver.get_misclassified">
<code class="sig-name descname">get_misclassified</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_loader</span></em>, <em class="sig-param"><span class="n">device</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/classification_solver.html#ClassificationSolver.get_misclassified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.classification_solver.ClassificationSolver.get_misclassified" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the information of the misclassified data items in the given dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_loader</strong> (<em>DataLoader</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> to use.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – A valid pytorch device string.</p></li>
<li><p><strong>data_loader</strong> (<em>torch.utils.data.dataloader.DataLoader</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple consisting of the image information, predicted, and actual class of the misclassified images.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-athena.solvers.regression_solver">
<span id="regression-solver-module"></span><h2><code class="docutils literal notranslate"><span class="pre">regression_solver</span></code> module<a class="headerlink" href="#module-athena.solvers.regression_solver" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="athena.solvers.regression_solver.RegressionSolver">
<em class="property">class </em><code class="sig-prename descclassname">athena.solvers.regression_solver.</code><code class="sig-name descname">RegressionSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/regression_solver.html#RegressionSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.regression_solver.RegressionSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">athena.solvers.base_solver.BaseSolver</span></code></p>
<p>A solver for regression problems. This solver supports models that have mulitple inputs, and thus,
multiple losses</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<em>nn.Module</em>) – The model to act on.</p>
</dd>
</dl>
<dl class="py method">
<dt id="athena.solvers.regression_solver.RegressionSolver.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epochs</span></em>, <em class="sig-param"><span class="n">train_loader</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">loss_fn</span></em>, <em class="sig-param"><span class="n">acc_fn</span></em>, <em class="sig-param"><span class="n">scheduler</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">test_loader</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">'cpu'</span></em>, <em class="sig-param"><span class="n">use_tqdm</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/regression_solver.html#RegressionSolver.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.regression_solver.RegressionSolver.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model.</p>
<blockquote>
<div><p><strong>Note</strong>: look at the notes in <a class="reference internal" href="#athena.solvers.regression_solver.RegressionSolver.train_step" title="athena.solvers.regression_solver.RegressionSolver.train_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">athena.solvers.regression_solver.RegressionSolver.train_step()</span></code></a> and in                 <a class="reference internal" href="#athena.solvers.regression_solver.RegressionSolver.test_step" title="athena.solvers.regression_solver.RegressionSolver.test_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">athena.solvers.regression_solver.RegressionSolver.test_step()</span></code></a>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>int</em>) – The number of epochs to train for.</p></li>
<li><p><strong>train_loader</strong> (<em>DataLoader</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the training data.</p></li>
<li><p><strong>optimizer</strong> (<em>Optimizer</em>) – The optimizer to use.</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>]</em>) – The loss function to use.                 the loss function should take in the predicted output of the model and target output from the dataset as                 the arguments and return a list of tuples, in which the first element of each tuple is a label for the                 loss and the second element is the loss value.</p></li>
<li><p><strong>acc_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>]</em>) – The accuracy                 function to use. The function should take in two arguments, first, a list of tuples, where the first element of each tuple is the label for the loss and the second element is the loss value, and the second argument                 the target output from the dataset. The function should return a list of tuples, first element of the tuple                 should be the label of the accuracy and the second element should be the accuracy value.</p></li>
<li><p><strong>scheduler</strong> (<em>LRScheduler</em><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">LRScheduler</span></code> to use. Defaults to None.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the test data. Defaults to None.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – A valid pytorch device string. Defaults to <code class="docutils literal notranslate"><span class="pre">cpu</span></code>.</p></li>
<li><p><strong>use_tqdm</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses tqdm instead of a keras style progress bar (<code class="docutils literal notranslate"><span class="pre">pkbar</span></code>). Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An History object containing training information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="athena.utils.html#athena.utils.history.History" title="athena.utils.history.History">History</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="athena.solvers.regression_solver.RegressionSolver.train_step">
<code class="sig-name descname">train_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train_loader</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">scheduler</span></em>, <em class="sig-param"><span class="n">device</span></em>, <em class="sig-param"><span class="n">loss_fn</span></em>, <em class="sig-param"><span class="n">acc_fn</span></em>, <em class="sig-param"><span class="n">use_tqdm</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/regression_solver.html#RegressionSolver.train_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.regression_solver.RegressionSolver.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single train step.</p>
<blockquote>
<div><p><strong>Note</strong>: the losses and accuracies returned by the <code class="docutils literal notranslate"><span class="pre">loss_fn</span></code> and <code class="docutils literal notranslate"><span class="pre">acc_fn</span></code> are divided by the                 number of batches in the dataset while recording them for an epoch (averaging). So make                 sure any reduction in your functions are ‘mean’.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<em>DataLoader</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the training data.</p></li>
<li><p><strong>optimizer</strong> (<em>Optimizer</em>) – The optimizer to use.</p></li>
<li><p><strong>scheduler</strong> (<em>LRScheduler</em>) – The LR scheduler to use.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – A valid pytorch device string.</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>]</em>) – The loss function to use.                 the loss function should take in the predicted output of the model and target output from the dataset as                 the arguments and return a list of tuples, in which the first element of each tuple is a label for the                 loss and the second element is the loss value.</p></li>
<li><p><strong>acc_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>]</em>) – The accuracy                 function to use. The function should take in two arguments, first, a list of tuples, where the first element of each tuple is the label for the loss and the second element is the loss value, and the second argument                 the target output from the dataset. The function should return a list of tuples, first element of the tuple                 should be the label of the accuracy and the second element should be the accuracy value.</p></li>
<li><p><strong>use_tqdm</strong> (<em>bool</em>) – If True, uses tqdm instead of a keras style progress bar (<code class="docutils literal notranslate"><span class="pre">pkbar</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list containing tuples in which the first element of the tuple is the label                 describing the value and the second element is the value itself.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[Tuple[str, torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="athena.solvers.regression_solver.RegressionSolver.test_step">
<code class="sig-name descname">test_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">test_loader</span></em>, <em class="sig-param"><span class="n">device</span></em>, <em class="sig-param"><span class="n">loss_fn</span></em>, <em class="sig-param"><span class="n">acc_fn</span></em>, <em class="sig-param"><span class="n">flush_print</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/athena/solvers/regression_solver.html#RegressionSolver.test_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#athena.solvers.regression_solver.RegressionSolver.test_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single test step.</p>
<blockquote>
<div><p><strong>Note</strong>: the losses and accuracies returned by the <code class="docutils literal notranslate"><span class="pre">loss_fn</span></code> and <code class="docutils literal notranslate"><span class="pre">acc_fn</span></code> are divided by the             number of batches in the dataset (while calculating the average loss and average accuracy during the             train step) and displayed as the result. So make sure any reduction in your functions are ‘mean’.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_loader</strong> (<em>DataLoader</em>) – The <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> for the test data.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – A valid pytorch device string.</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>]</em>) – The loss function to use.                 the loss function should take in the predicted output of the model and target output from the dataset as                 the arguments and return a list of tuples, in which the first element of each tuple is a label for the                 loss and the second element is the loss value.</p></li>
<li><p><strong>acc_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>]</em>) – The accuracy                 function to use. The function should take in two arguments, first, a list of tuples, where the first element of each tuple is the label for the loss and the second element is the loss value, and the second argument                 the target output from the dataset. The function should return a list of tuples, first element of the tuple                 should be the label of the accuracy and the second element should be the accuracy value.</p></li>
<li><p><strong>flush_print</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to flush the print statement or not. Needed when tqdm is used in a notebook. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list containing tuples in which the first element of the tuple is the label                 describing the value and the second element is the value itself.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[Tuple[str, torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="athena.utils.html" class="btn btn-neutral float-right" title="athena.utils package" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="athena.models.html" class="btn btn-neutral" title="athena.models package" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">athena.solvers package</a><ul>
<li><a class="reference internal" href="#module-athena.solvers.classification_solver"><code class="docutils literal notranslate"><span class="pre">classification_solver</span></code> module</a></li>
<li><a class="reference internal" href="#module-athena.solvers.regression_solver"><code class="docutils literal notranslate"><span class="pre">regression_solver</span></code> module</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
        <p>
          Built with Sphinx and the 
          <a href="https://github.com/pytorch/pytorch_sphinx_theme">pytorch sphinx theme</a>
        </p>
        
    </div>
  </div>

  <!-- <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div> -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>